---
title: "作業1"
output: html_notebook
params:
  name: ["林云方"]
  id: [710661123]
  group: 9
---
請依狀況更改上面的name,id及group（分別代表組員姓名，學號及組號），但請勿更改下面三行的設定。  

***
姓名：`r params$name`  
學號：`r params$id`  
組號：`r params$group`  

***

請直接在本檔案作答，存檔時也無需另存新檔名。交作業時，只由「組長」送出pull request給我。

作業除了讓同學檢視課堂所學程式外，有些題目只會給你未教過的函數建議（純為建議，你也可以不使用），你必需使用Help或網路查尋去了解函數的正確使用；搜詢正確程式函數使用的能力，也是程式設計的基本功。

如果是程式的答案，請設立如下的chunk區塊並在裡面作答
```{r}
#你的程式答案
```

如果是文字答案，請設立沒有{r}的chunk區塊並在裡面作答。
```
你的文字答案。
```

# 教育與薪資 

一開始請執行
```{r}
rm(list=ls())
library(dplyr)
library(psych)
library(haven)
wage1 <- read_dta("http://fmwww.bc.edu/ec-p/data/wooldridge/wage1.dta")
```

1. 請依據此[連結](http://fmwww.bc.edu/ec-p/data/wooldridge/wage1.des)說明wage1資料的來源及變數代表意義。[其中potential experience指得是推估工作經驗年資]
```
資料的來源：
http://fmwww.bc.edu/ec-p/data/wooldridge/datasets.list.html
變數代表意義：
wage=平均每小時收入
educ=教育年數
exper=推估工作經驗年資
tenure＝和現任雇主的年數
nonwhite＝1如果為非白人            
female＝1如果為女性                  
married＝1如果已婚                  
numdep＝家庭人數                   
smsa＝1如果住在SMSA                    
northcen＝1如果住在美國中北部                
south＝1如果住在南部地區                   
west＝1如果住在西部地區                     
construc＝1如果在建設產業上班                 
ndurman＝1如果在非耐久財製造產業                
trcommpu ＝1如果在交通運輸，通訊，大眾ut
trade＝1如果是批發貨零售                    
services＝1如果是服務業的產業                 
profserv＝1如果是專業服務產業                 
profocc＝1如果是教授職業                  
clerocc＝1如果是文書職業                  
servocc＝1如果是做服務的工作        
lwage＝工資取log                    
expersq＝推估工作經驗年資平方
tenursq＝和現任雇主的年數平方               
```
我們想要問："教育年限增加一年對勞動薪資的影響有多少？"

2. 請使用`psych::pairs.panels()`來描述教育年限(educ)與勞動薪資(wage)間的特質。在兩者的相關度上，有沒有那個變數取對數(log)會比較好？為什麼？
```{r}
library('psych')
wage1 %>% 
  dplyr::select(wage,educ) %>%
  psych::pairs.panels()
```

```{r}
library('psych')
wage1 %>%
  dplyr::select(wage,educ) %>%
  mutate(logw=log(wage)) %>%
  dplyr::select(logw,educ) %>%
  psych::pairs.panels()
```
```
因為educ的數值中有0，因此educ不能取log，
已將wage取log，但效果不彰，因為相關係數只上升0.02，而且資料還是很集中，因此沒有哪個變數取log會比較好。
```

3. 請使用OLS估計以下的迴歸模型：
$$log(wage)=\beta_0+\beta_1 educ+\epsilon$$
```{r}
wage1 %>%
  lm(log(wage)~educ,data=.) %>%
  summary()
```

4. 從資料裡選出兩個可能造成$\beta_1$OLS估計值帶有選擇性偏誤的變數，請說明理由並加以適當敍述統計量佐證。
```{r}
library("knitr")
is_numeric<-function(x) all(is.numeric(x))
cor_educ<-function(x) cor(x,wage1$educ)
wage1 %>%
  select_if(is_numeric) %>%
  summarise_all(cor_educ) %>%
  kable()
```

```
expersq是推估工作經驗年資平方，它和教育是反向關係，他們的相關係數是-0.3312559，因此若漏了此變數，可能會高估教育的報酬。其實該複回歸模型應該加入exper變數，才能正確捕捉工資和工作經驗的關係。
profocc是教授職業，因為是教授，所以教授的教育年數就高，所以比較的有可能不是教育年數，而是職業是不是教授。職業是教授和教育年數的相關係數是0.4967681。
```
5. 延續上題，請完成對應複迴歸模型的估計。
```{r}
wage1 %>%
  lm(log(wage)~educ+profocc+expersq,data=.) %>%
  summary()
```

6. 大致說來，教育年限12年表示高中畢業，大學畢業會有16年的教育，請問介於12年以上-16年以下的教育年限代表什麼？
```
大學肄業
```
7. 取出教育年限介於12-16年（含上下限）的資料，分別計算以下三群教育年限勞動者的平均薪資：12年，13-15年，16年。
[hint: dplyr::filter(), dplyr::group_by(), dplyr::summarise(), cut()]
```{r}
wage1 %>%
dplyr::filter(12<=educ&educ<=16)->wage1216
wage1216%>%
dplyr::group_by(cut(wage1216$educ,breaks=c(12,12.9,15,16),include.lowest = T))%>%
summarise(avg=mean(wage),N = n())

```

8. 在下一部份的文章閱讀練習裡，文章提到: 

> In a comparison of the earnings of people with degrees and people without them, those who start university but do not finish are lumped in with those who never started, even though they, too, will have paid fees and missed out on earnings. Their numbers are considerable. 

在問題7中我們計算了三群人的平均薪資。請問若要避免文章所描述的問題，你會如何計算一位高中生若選擇上大學他會得到的預期薪資好處。[只使用問題7的數字及三群人人數]
p=68/(113+68) The probability graduate from college
p*8.04+(1-p)*6.03-5.37
```{r}
(68/(113+68))*8.041618+(113/(68+113))*6.030000-5.371364
```


# 文章閱讀
[Going to university is more important than ever for young people.
But the financial returns are falling.](https://www.economist.com/news/international/21736151-financial-returns-are-falling-going-university-more-important-ever)

文章中有不少效應評估問句，及造成其無法直接進行簡單迴歸估計的選擇性偏誤原因，請將所有這樣的段落貼過來、寫下它的效應評估問句及造成選擇性偏誤的原因。例如：

```
1. Policymakers regard it as obvious that sending more young people to university will boost economic growth and social mobility. ... But comparisons between countries provide little evidence of these links. Richer countries have more graduates, but that could be because there is more money to spare, and less urgency to start earning.

效應評估問句：越多人上大學該國經濟表現越好？

造成選擇性偏誤原因：「時間多錢多多」造成「越多人上大學」，「時間多錢多多」是「富有國家」常見現象，所以單純比較上大學比例高和低的國家，有可能只是在比誰的「時間多、錢多」。（這類的選擇性偏誤也稱為內生性偏誤。）
```
1.The Economist’s analysis of the data finds that returns are linked to the share of people with degrees, and the range of earnings....

Most students know that a degree in mathematics or finance is likely to be more lucrative than one in music or social work. What fewer realise is that the graduate premium overstates the financial benefit of embarking on a degree if their school grades barely qualify them for entry, no matter what they study.....

Including dropouts when calculating the returns to going to university makes a big difference. In a new book, “The Case Against Education”, Bryan Caplan of George Mason University argues that the low graduation rates of marginal students, and the fact that, for a given level of qualification, cleverer people tend to earn more, mean that the return on a four-year degree in America ranges from 6.5% for excellent students to just 1% for the weakest ones.

效應評估問句:報酬率和擁有學位的人的比例有關？
造成選擇性偏誤原因：
  雖然數學或金融學位可能比音樂或社會工作更有利可圖，但不管大學學位在哪一個領域學習，必須具備一定的能力才能進入學校，所以能上大學和能力有一定的相關。而資料上顯示，邊緣學生的畢業率低，而擁有一定水平的資格且聰明的人傾向賺取更多，優秀學生的回報率是6.5％，最差的學生只有1％，中間的差距即是能力的差距，在同樣學歷下，能力差也會有影響。
```
2.filter

